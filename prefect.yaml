prefect-version: 2.0
name: netauto-orchestrator

pull:
  - prefect.deployments.steps.git_clone:
      repository: https://github.com/lancamat1/netauto-orchestrator-demo.git
      branch: main

definitions:
  work_pools:
    - k8s_alef_dc: &k8s_alef_dc
        name: k8s-alef-dc
        work_queue_name: default
        job_variables:
          image: "prefecthq/prefect:3-python3.12"
          namespace: "prefect"

deployments:
  - name: webhook-handler
    version: "1.0.0"
    description: "Generic webhook handler for Infrahub events - logs payload for inspection"
    entrypoint: flows/webhook_handler.py:webhook_handler
    schedule: null
    parameters: {"webhook_payload": {}}
    work_pool: *k8s_alef_dc
